# RK3568 01 linux命令

## 一、DRM

## 二、V4L2

```shell
# 查看v4l2对应设备
grep '' /sys/class/video4linux/video*/name

# v4l2 捕捉
v4l2-ctl -d /dev/video0 --set-fmt-video=width=1536,height=288,pixelformat=GRAY8 --stream-mmap=3 --stream-to=pic.yuv --stream-count=10

v4l2-ctl -d /dev/video5 --set-fmt-video=width=640,height=480,pixelformat=NV16 --stream-mmap=3 --stream-to=pic.yuv --stream-count=1

v4l2-ctl -d /dev/video0 --set-crop top=0,left=0,width=1536,height=288
```

## 三、GST

```shell
# 实时预览
gst-launch-1.0 v4l2src device=/dev/video5 !video/x-raw, format=NV12, width=640, height=480, framerate=30/1 ! waylandsink

gst-launch-1.0 v4l2src device=/dev/video0 !video/x-raw, format=NV16, width=728, height=288, framerate=50/1 ! waylandsink

gst-launch-1.0 v4l2src device=/dev/video0 io-mode=dmabuf ! video/x-raw, format=GRAY8, width=1536, height=288, framerate=200/1 ! videoconvert ! video/x-raw, format=NV16 ! waylandsink

# 采集H.264
gst-launch-1.0 v4l2src device=/dev/video5 num-buffers=100 !video/x-raw,format=NV12, width=640,height=480 ! tee name=t ! queue !mpph264enc !queue !h264parse !qtmux !filesink location=13850_h264.mp4 t. ! queue !waylandsink

gst-launch-1.0 v4l2src device=/dev/video0 num-buffers=100 !video/x-raw,format=NV16, width=1536,height=288 ! tee name=t ! queue !mpph264enc !queue !h264parse !qtmux !filesink location=dvp.mp4 t. ! queue !waylandsink

# 播放视频
gst-launch-1.0 filesrc location=13850_h264.mp4 !qtdemux !queue !h264parse !mppvideodec !waylandsink
```

## 四、硬盘读写IO

```shell
# 写入
time dd if=/dev/zero of=test.w bs=4k count=100000

# 读取
time dd if=/dev/sdb of=/dev/null bs=4k

# 读写
time dd if=/dev/sdb of=/test.w bs=4k
```

## 五、GST配置修改

```shell
sed -i 's/^#include <gst\//#include <gstreamer-1.0\/gst\//g' *.h
sed -i 's/^#include <glib\//#include <glib-2.0\/glib\//g' *.h
sed -i 's/^#include <gobject\//#include <glib-2.0\/gobject\//g' *.h
sed -i 's/^#include <glib.h>/#include <glib-2.0\/glib.h>/g' *.h
sed -i 's/^#include <glib-object.h>/#include <glib-2.0\/glib-object.h>/g' *.h
```